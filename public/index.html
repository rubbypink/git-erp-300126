<!DOCTYPE html>
<html lang="vi">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
  <title>9 Trip Phu Quoc - Du Lịch Dễ Dàng...</title>
  <link rel="icon" type="image/png" href="./src/images/favicon.png?v=2">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />

  <link rel="stylesheet" href="./src/css/main.css">
  <link rel="stylesheet" href="./src/css/notification-panel.css">

  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-functions.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-messaging.js"></script>
</head>

<body>
  <div id="app-launcher" class="d-flex justify-content-center align-items-center vh-100 vw-100 flex-column">
    <img src="./src/images/favicon.png" height="300" class="mb-3 animate__animated animate__pulse animate__infinite">
    <div class="spinner-border text-primary" role="status"></div>
    <p class="mt-3 text-muted fw-bold">ĐANG KHỞI CHẠY HỆ THỐNG...</p>
  </div>
  <div class="app-container d-none" style="opacity: 0; transition: opacity 0.9s;" id="main-app">
  </div>
  <script>
    const GAS_API_URL = "https://script.google.com/macros/s/AKfycby_54qWXvDLG3Jm6s-jAH75S6dO1L6X1rmHrnqJ5I2CQBw4QQa1t3u4QKcEA98kI8qV/exec";
    var CURRENT_USER = {
      role: 'sale',
      email: '',
      level: 1,
      maskedRole: '',
      profile: {}
    };
    var ADMIN_EMAILS = ['tranthuaanh90@gmail.com', '9tripphuquoc@gmail.com', 'tranthuaanh90@9tripphuquoc.com'];
    var JS_MANIFEST = {
      sale: ['logic_sales.js', 'api_sales.js'],
      op: ['logic_operator.js', 'api_operator.js'],
      acc: ['controller_accountant.js'],
      acc_thenice: ['controller_accountant.js']
    };
    var TEMPLATE_MANIFEST = {
      base: ['tmpl-dashboard', 'tmpl-form'],
      sale: ['tmpl-sub-form', 'tmpl-confirmation-modal'],
      op: ['tmpl-partner-mail'],
      acc: ['tmpl-report', 'tmpl-acc-footer-bar'],
      acc_thenice: ['tmpl-report', 'tmpl-acc-footer-bar']
    };
    var COLL_MANIFEST = {
      admin: ['bookings', 'booking_details', 'customers', 'operator_entries', 'transactions', 'suppliers', 'fund_accounts', 'transactions_thenice', 'fund_accounts_thenice', 'users'],
      sale: ['bookings', 'booking_details', 'customers'],
      op: ['bookings', 'operator_entries', 'suppliers', 'hotels', 'hotel_price_schedules', 'service_price_schedules'],
      acc: ['transactions', 'suppliers', 'fund_accounts', 'bookings', 'operator_entries'],
      acc_thenice: ['transactions_thenice', 'fund_accounts_thenice']
    };    
  </script>

  <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script defer src="./src/js/utils.js"></script>
  <script async src="./src/js/common/components/offcanvas_menu.js"></script>
  <script defer src="./src/js/theme-manager-v2.js"></script>
  <script async src="./src/js/common/components/calculator_widget.js"></script>
  <script defer src="./src/js/db_schema.js"></script>
  <script async src="./src/js/shortkey.js"></script>
  <script defer src="./src/js/renderer.js"></script>
  <script defer src="./src/js/common/components/Menu_StyleChrome.js"></script>
  <script defer src="./src/js/logic_base.js"></script>
  <script defer src="./src/js/api_base.js"></script>
  <script defer src="./src/js/common/components/notification-panel-renderer.js"></script>
  <script type="module" src="./src/js/app.js"></script>
  <script async src="./src/js/logic_report.js"></script>

  <!-- Service Worker Registration for Notifications -->
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('./firebase-messaging-sw.js', { scope: '/' })
        .then(reg => {
          console.log('✓ Service Worker registered:', reg.scope);
        })
        .catch(err => {
          console.warn('✗ Service Worker registration failed:', err);
        });
    }
  </script>
</body>

</html>